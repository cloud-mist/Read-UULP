# 缓冲区

- 缓冲区的大小对性能有很大影响。因为缓冲区大的话，可以少系统调用几次，从而节省时间。每次的话，需要用户态和内核态的转换，要保存上下文信息，所以有很大的开销。
- who2 版本是低效的，因为它每次只取一条记录。完全可以一次取多条记录，放到 buffer 里， buffer 里没了，再去取。

## 内核缓冲

内核会把磁盘数据做缓冲

- 内核将磁盘数据复制到`内核缓冲区`,当用户空间的进程从磁盘读取数据，内核不直接读取磁盘，把内核缓冲区的数据复制到进程缓冲区中。
  当进程要求的数据块不再内核缓冲区，内核就会把相应数据块加入请求数据访问列表，把该进程挂起，服务其他进程。
